<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>chapter 10 | Effective Java Study</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/effective-java-study/assets/css/0.styles.612e3498.css" as="style"><link rel="preload" href="/effective-java-study/assets/js/app.34abd0d4.js" as="script"><link rel="preload" href="/effective-java-study/assets/js/2.28ccdcca.js" as="script"><link rel="preload" href="/effective-java-study/assets/js/12.7f3dee67.js" as="script"><link rel="prefetch" href="/effective-java-study/assets/js/10.1e0a4467.js"><link rel="prefetch" href="/effective-java-study/assets/js/11.d58abc29.js"><link rel="prefetch" href="/effective-java-study/assets/js/13.f5726a00.js"><link rel="prefetch" href="/effective-java-study/assets/js/14.bdf148c5.js"><link rel="prefetch" href="/effective-java-study/assets/js/3.804d668d.js"><link rel="prefetch" href="/effective-java-study/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/effective-java-study/assets/js/5.40f81d9d.js"><link rel="prefetch" href="/effective-java-study/assets/js/6.a084c838.js"><link rel="prefetch" href="/effective-java-study/assets/js/7.3c66e73f.js"><link rel="prefetch" href="/effective-java-study/assets/js/8.443cd7ba.js"><link rel="prefetch" href="/effective-java-study/assets/js/9.f3d8b2ea.js">
    <link rel="stylesheet" href="/effective-java-study/assets/css/0.styles.612e3498.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/effective-java-study/" class="home-link router-link-active"><!----> <span class="site-name">Effective Java Study</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/effective-java-study/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/effective-java-study/sample.html" class="nav-link">
  Sample
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/effective-java-study/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/effective-java-study/sample.html" class="nav-link">
  Sample
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>chapter 10</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/effective-java-study/chapter10/#chapter-10" class="sidebar-link">chapter 10</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/effective-java-study/chapter10/#예외" class="sidebar-link">예외</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_69-예외는-진짜-예외-상황에만-사용하라" class="sidebar-link">69. 예외는 진짜 예외 상황에만 사용하라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_70-복구할-수-있는-상황에는-검사-예외를-프로그래밍-오류에는-런타임-예외를-사용하라" class="sidebar-link">70. 복구할 수 있는 상황에는 검사 예외를, 프로그래밍 오류에는 런타임 예외를 사용하라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_71-필요-없는-검사-예외-사용은-피하라" class="sidebar-link">71. 필요 없는 검사 예외 사용은 피하라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_72-표준-예외를-사용하라" class="sidebar-link">72. 표준 예외를 사용하라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_73-추상화-수준에-맞는-예외를-던지라" class="sidebar-link">73. 추상화 수준에 맞는 예외를 던지라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_74-메서드가-던지는-모든-예외를-문서화하라" class="sidebar-link">74. 메서드가 던지는 모든 예외를 문서화하라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_75-예외의-상세-메시지에-실패-관련-정보를-담으라" class="sidebar-link">75. 예외의 상세 메시지에 실패 관련 정보를 담으라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_76-가능한-한-실패-원자적으로-만들라" class="sidebar-link">76. 가능한 한 실패 원자적으로 만들라</a></li><li class="sidebar-sub-header"><a href="/effective-java-study/chapter10/#_77-예외를-무시하지-말라" class="sidebar-link">77. 예외를 무시하지 말라</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="chapter-10"><a href="#chapter-10" class="header-anchor">#</a> chapter 10</h2> <h2 id="예외"><a href="#예외" class="header-anchor">#</a> 예외</h2> <h3 id="_69-예외는-진짜-예외-상황에만-사용하라"><a href="#_69-예외는-진짜-예외-상황에만-사용하라" class="header-anchor">#</a> 69. 예외는 진짜 예외 상황에만 사용하라</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    range<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">climb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArrayIndexOutOfBoundsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li><p>이 코드의 의도 : JVM은 배열에 접근할 때마다 경계를 넘는지 검사하고, 일반적인 반복문도 배열 경계에 도달하면 종료</p> <ul><li>이 검사를 반복문에도 명시하면 같은 일이 중복되므로 하나를 줄여서 성능을 높여보려 한 것</li> <li>하지만 잘못된 추론</li></ul></li> <li><p>예외를 활용하여 다른 방향으로 사용하려고 하면 안 된다 (일상적인 제어 흐름 - 예외를 마주쳐서 작업을 종료하는 동작 등)</p></li> <li><p>제목대로, 진짜 예외 상황에만 사용한다</p></li> <li><p>잘 설계된 API라면 클라이언트가 정상적인 제어 흐름에서 예외를 사용할 일이 없게 해야 함</p></li> <li><p>상태 검사 대신 : 올바르지 않은 상태일 때 빈 옵셔널이나 null과 같은 값을 반환하기</p> <ol><li>외부 동기화 없이 여러 스레드가 동시 접근 가능 / 외부 요인으로 상태 변경이 가능하다면 옵셔널이나 특정 값 사용</li> <li>성능이 중요한 상황에서 상태 검사 메서드가 상태 의존적 메소드의 작업 일부를 중복 수행한다면 옵셔널이나 특정 값 사용</li> <li>다른 모든 경우엔 상태 검사 메소드 방식이 좀 더 나음</li></ol></li></ul> <h3 id="_70-복구할-수-있는-상황에는-검사-예외를-프로그래밍-오류에는-런타임-예외를-사용하라"><a href="#_70-복구할-수-있는-상황에는-검사-예외를-프로그래밍-오류에는-런타임-예외를-사용하라" class="header-anchor">#</a> 70. 복구할 수 있는 상황에는 검사 예외를, 프로그래밍 오류에는 런타임 예외를 사용하라</h3> <ul><li><p>호출하는 쪽에서 복구하리라 여겨지는 상황이라면 Checked Exception</p> <ul><li>메소드 선언에 포함된 Checked Exception은 그 메서드를 호출했을 때 유력한 결과임을 API 사용자에게 알려주는 것임</li></ul></li> <li><p>프로그래밍 오류를 나타낼 때는 Runtime Exception (Unchecked Exception의 일부)</p> <ul><li>런타임 에러의 대부분은 전제조건(API 명세에 기록된 제약)을 지키지 못했을 때 발생</li></ul></li> <li><p>다만, 복구할 수 있는 상황인지 프로그래밍 오류인지가 항상 명확히 구분되지는 않음</p></li> <li><p>예외 역시 어떤 메서드라도 정의할 수 있는 완벽한 객체이다!! 잊지 말 것!</p> <ul><li>예외의 메서드는 그 예외를 일으킨 상황에 대한 정보를 코드 형태로 전달할 때
<ul><li>이런 코드가 없다면 오류 메시지를 파싱해야 하겠지... 그것보단 코드가 좋다...</li></ul></li></ul></li></ul> <h3 id="_71-필요-없는-검사-예외-사용은-피하라"><a href="#_71-필요-없는-검사-예외-사용은-피하라" class="header-anchor">#</a> 71. 필요 없는 검사 예외 사용은 피하라</h3> <ul><li><p>과하게 사용하면 쓰기 불편한 API가 됨</p></li> <li><p>Checked Exception을 던지는 메소드는 스트림 안에서 직접 사용할 수 없음</p></li> <li><p>Checked Exception을 회피하는 가장 쉬운 방법은 적절한 결과 타입을 담은 옵셔널 반환</p> <ul><li>단점 : 예외가 발생한 이유를 알려주는 부가 정보를 담을 수 없음</li> <li>또 다른 방법 : Chekced Exception을 던지는 메소드를 2개로 쪼개 Unchecked exception으로 바꾸기</li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// BEFORE</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TheCheckedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">// 예외 상황에 대처</span>
  <span class="token punctuation">}</span>
<span class="token comment">// AFTER</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">actionPermitted</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">// 예외 상황에 대처</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_72-표준-예외를-사용하라"><a href="#_72-표준-예외를-사용하라" class="header-anchor">#</a> 72. 표준 예외를 사용하라</h3> <ul><li>표준 예외를 사용하면 다른 사람이 여러분의 API를 익히고 사용하기 쉬워짐</li> <li>자주 쓰이는 표준 예외들
<ul><li>IllegalArgumentException</li> <li>IllegalStateException</li> <li>NullPointerException</li> <li>IndexOutOfBoundsException</li> <li>ConcurrentModifiationException</li> <li>UnspportedOperationException</li></ul></li></ul> <h3 id="_73-추상화-수준에-맞는-예외를-던지라"><a href="#_73-추상화-수준에-맞는-예외를-던지라" class="header-anchor">#</a> 73. 추상화 수준에 맞는 예외를 던지라</h3> <ul><li>예외 번역(exception translation) : 상위 계층에서 저수준 예외를 잡아 자신의 추상화 수준에 맞는 예외로 바꿔 던지기</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">LowerLevelException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HigherLevelException</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>Item 20. AbstractSequentialList에서 수행하는 예외 번역의 예</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">ListIterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> i <span class="token operator">=</span> <span class="token function">listIterator</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> i<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchElementException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token string">&quot;Index: &quot;</span> <span class="token operator">+</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>예외 번역시, 저수준 예외가 디버깅에 도움이 된다면 예외 연쇠(exception chaining)을 사용하는 게 좋음
<ul><li>문제의 근본 원인(cause)인 저수준 예외를 고수준 예외에 실어 보내는 방식</li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">LowerLevelException</span> cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HigherLevelException</span><span class="token punctuation">(</span>cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>가능하다면 저수준 메서드가 반드시 성공하도록 하여 아래 계층에서는 예외가 발생하지 않도록 하는 것이 최선
<ul><li>차선책 : 아래 계층에서의 예외를 피할 수 없다면, 상위 계층해서 조용히 처리하여 문제를 API 호출자에게까지 전파하지 않기
<ul><li>다만 Logging을 하자!</li></ul></li></ul></li></ul> <h3 id="_74-메서드가-던지는-모든-예외를-문서화하라"><a href="#_74-메서드가-던지는-모든-예외를-문서화하라" class="header-anchor">#</a> 74. 메서드가 던지는 모든 예외를 문서화하라</h3> <ul><li>Checked Exception의 경우는 <code>@throws</code> 태그를 사용하여 정확히 문서화하기</li> <li>Unchecked Exception은 throws 목록에 넣지 말기</li> <li>한 클래스에 정의된 많은 메서드가 같은 이유로 예외를 던진다면 클래스 설명에 추가하는 방법도 있음</li></ul> <h3 id="_75-예외의-상세-메시지에-실패-관련-정보를-담으라"><a href="#_75-예외의-상세-메시지에-실패-관련-정보를-담으라" class="header-anchor">#</a> 75. 예외의 상세 메시지에 실패 관련 정보를 담으라</h3> <ul><li>실패 순간을 포착하려면 발생한 예외에 관여된 모든 매개변수와 필드의 값을 실패 메시지에 담아야 (제발ㅠㅠ)
<ul><li>IndexOutOfBoundsException이라면 : 범위의 최소값, 최대값, 그 범위를 벗어난 인덱스의 값</li></ul></li> <li>예외의 상세 메시지와 최종 사용자에게 보여줄 오류 메시지는 다르다 !!</li> <li>실패를 적절히 포착하려면 : 필요한 정보를 예외 생성자에서 모두 받아서 상세 메시지까지 미리 생성해놓는 방법도 괜찮다</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>  <span class="token keyword">public</span> <span class="token function">indexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token keyword">int</span> lowerBound<span class="token punctuation">,</span> <span class="token keyword">int</span> upperBound<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><h3 id="_76-가능한-한-실패-원자적으로-만들라"><a href="#_76-가능한-한-실패-원자적으로-만들라" class="header-anchor">#</a> 76. 가능한 한 실패 원자적으로 만들라</h3> <ul><li>호출된 메서드가 실패하더라도 해당 객체는 메서드 호출 전 상태를 유지해야 한다
<ul><li>실패 원자적(failure-atomic)</li></ul></li> <li>실패 원자적으로 만드는 방법
<ol><li>불변 객체로 설계하기</li> <li>실패할 가능성이 있는 모든 코드를, 객체의 상태를 바꾸는 코드보다 앞에 배치</li> <li>객체의 임시 복사본에서 작업을 수행한 후, 작업이 완료되면 원래 객체와 교체</li> <li>작업 도중 발생하는 실패를 가로채는 복구 코드를 작성 (자주 쓰이지 X)</li></ol></li></ul> <h3 id="_77-예외를-무시하지-말라"><a href="#_77-예외를-무시하지-말라" class="header-anchor">#</a> 77. 예외를 무시하지 말라</h3> <ul><li>이렇게 짜면 곤란하다</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SomeExcpetion</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>가끔 무시해야 할 때도 있지만(FileInputStream처럼) 그럴 때에는 예외 변수의 이름이라도 ignored로 바꿔 주자</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExceptionException</span> ignored<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/effective-java-study/assets/js/app.34abd0d4.js" defer></script><script src="/effective-java-study/assets/js/2.28ccdcca.js" defer></script><script src="/effective-java-study/assets/js/12.7f3dee67.js" defer></script>
  </body>
</html>
